# Stabilize snapshot handling to avoid empty flashes

- Area: PhaseManager, TaskListManager, EnhancedTaskManager
- Problem: Right after navigation or write operations, lists briefly render empty (or counts go to 0) until first snapshot arrives or re-attaches.
- Root cause:
  - Clearing arrays when `snapshot` is `nil`/missing in listeners
  - Tearing down listeners on view disappear
- Fix (implemented):
  - Do not clear arrays when `snapshot` is missing
    - PhaseManager.startListeningForPhases: keep existing `phases`
    - TaskListManager.startListeningForTaskLists: keep existing `taskLists`
    - EnhancedTaskManager.startListeningForTasks: keep existing `tasks`
  - Prevent duplicate listeners by calling `removeAllListeners()` at start of `startListening...` (PhaseManager, TaskListManager)
  - Guard against re-registering direct task listener (EnhancedTaskManager)
- Acceptance:
  - No visible flicker to empty/0 state on appear or after write
  - Single active listener per scope (no duplication, no missed updates)
- Files:
  - iOS/shigodeki/PhaseManager.swift
  - iOS/shigodeki/TaskListManager.swift
  - iOS/shigodeki/EnhancedTaskManager.swift
